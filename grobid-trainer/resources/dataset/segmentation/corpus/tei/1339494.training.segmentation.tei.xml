<?xml version="1.0" ?>
<tei>
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<titlePage> KIT SCIENTIFIC WORKING PAPERS <lb/> The EHISTORY and MUPROD Options of the <lb/>Air Shower Simulation Program CORSIKA <lb/> by D. Heck <lb/> 1 , R. Engel <lb/> 1 <lb/> 5 <lb/> 1 Institute for Nuclear Physics, Karlsruhe Institute of Technology (KIT) <lb/> Impressum <lb/> Karlsruher Institut für Technologie (KIT) <lb/>www.kit.edu <lb/> Diese Veröffentlichung ist im Internet unter folgender Creative Commons-Lizenz <lb/>publiziert: http://creativecommons.org/licenses/by-nc-nd/3.0/de <lb/> 2013 <lb/>ISSN: 2194-1629 <lb/></titlePage>

			<page> III <lb/></page>

			<front> Abstract <lb/> The EHISTORY and MUPROD Options of the <lb/>Air Shower Simulation Program CORSIKA <lb/> This report describes the EHISTORY and MUPROD options, which give addi-<lb/>tional information for all muons on their precursors, the grandmother and mother <lb/>particles. These muons may arrive at the detector level or – with the MUPROD <lb/>option – may decay or interact before reaching the detector level. These informa-<lb/>tions may help to improve the understanding of the production and propagation of <lb/>muons in air showers. <lb/> Zusammenfassung <lb/> Die EHISTORY und MUPROD Optionen des <lb/>Luftschauer-Simulationsprogramms CORSIKA <lb/> Dieser Bericht beschreibt die EHISTORY-und MUPROD-Optionen, die für <lb/>alle Myonen zusätzliche Informationen über ihre Vorläufer, die Großmutter-und <lb/>Mutter-Teilchen, geben. Diese Myonen können das Detektor-Niveau erreichen <lb/>oder – mit der MUPROD-Option – können zerfallen oder wechselwirken, bevor <lb/>sie das Detektor-Niveau erreichen. Diese Informationen sind hilfreich für ein tief-<lb/>eres Verständnis der Erzeugung und Ausbreitung der Myonen in Luftschauern. <lb/></front>

			<page> IV <lb/>V <lb/></page>

			<body> Contents <lb/> 1 Introduction <lb/>1 <lb/>2 Extended Additional Muon Information <lb/>2 <lb/> 2.1 Mother Particle . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 <lb/>2.2 Grandmother Particle . . . . . . . . . . . . . . . . . . . . . . . . 4 <lb/> 3 MUPROD Option <lb/>4 <lb/> 3.1 Decaying Muon at Production . . . . . . . . . . . . . . . . . . . 5 <lb/>3.2 Muon at Decay Point . . . . . . . . . . . . . . . . . . . . . . . . 5 <lb/> 4 Hadronic Generation Counter <lb/>7 <lb/>5 Example of Data Structure <lb/>10 <lb/>6 Limitations <lb/>12 <lb/> 6.1 Neutrino Induced Showers . . . . . . . . . . . . . . . . . . . . . 12 <lb/>6.2 Thinning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 <lb/>6.3 Combination with STACKIN Option . . . . . . . . . . . . . . . . 12 <lb/> 7 Application Example <lb/>13 <lb/>8 Final Remarks <lb/>14 <lb/> A Installation of the EHISTORY Option <lb/>15 <lb/> References <lb/> 16 <lb/></body>

			<page> VI <lb/> 1 <lb/></page>

			<body> 1 Introduction <lb/> There are indications, that in Extensive Air Showers (EAS) simulated with the <lb/>cosmic ray shower simulation program CORSIKA [1], most high-energy inter-<lb/>action models produce a significantly too low number of muons compared with <lb/>experimental findings [2, 3, 4, 5, 6, 7, 8]. To improve the models one must know <lb/>how the number and density of muons depend on the model parameters. This <lb/>knowledge may be acquired by back-tracking the history of the muons. Therefore <lb/>in simulations it is desirable to store parameters like energy and the components <lb/>of momentum and position of the mother and grandmother particles at the last <lb/>hadronic interaction for further analysis before the mother particle decays to a <lb/>muon. This capability is provided by the option EHISTORY. <lb/>Usually the muons originate from the decay of charged pions or charged kaons, <lb/>but also the K <lb/> 0 <lb/> L  mesons contribute to some extend to the muon number by a 27 % <lb/>branch of their decays. Additionally from the electro-magnetic component of an <lb/>EAS the γ-rays with energies above ≈1 TeV produce (with a small production <lb/>cross-section) µ <lb/> + <lb/> µ <lb/> −  -pairs. At even higher energies the production of charmed <lb/>hadrons increases the number of muons arriving at ground and especially the de-<lb/>cay of the D-mesons contributes to the high energy portion (E  µ  &gt; 50 TeV) of <lb/>the muon energy spectrum [9, 10, 11]. By systematic studies of those interac-<lb/>tions, which precede the mesonic decay to muons, the importance of low en-<lb/>ergy hadronic interactions of pionic, kaonic or nucleonic projectiles (referred to <lb/>as grandmother particles) with air became obvious and triggered a more system-<lb/>atic study of such interactions in fixed target accelerator experiments [12, 13]. <lb/>The option MUPROD is developed to extend these investigations to get infor-<lb/>mation on muons which decay rsp. interact within the atmosphere without reach-<lb/>ing the observation level. Thus at the muon&apos;s origin and decay rsp. interaction <lb/>point the components of momentum and position are written out to the particle <lb/>data output file. To get moreover the information on mother and grandmother <lb/>particles of the decaying muons the MUPROD option is designed to be combined <lb/>with the EHISTORY option. <lb/>The implementation of the EHISTORY and MUPROD options is done in a <lb/>manner that they are compatible with nearly all other options available for COR-<lb/>SIKA. Especially the EHISTORY and MUPROD options can be combined with <lb/>all high-energy and low-energy hadronic interaction models without any restric-<lb/>tions. The EHISTORY and MUPROD options may be combined also with the <lb/>STACKIN option (see Sect. 6.3) which reads in the secondary particles of a pri-<lb/>mary interaction which is not foreseen in the usual high-energy interaction codes <lb/>coupled with CORSIKA. If the NUPRIM option is used, which handles the devel-<lb/>opment of EAS induced by primary neutrinos of all three kinds (ν  e  , ν  µ  , and ν  τ  ) by <lb/>a call to HERWIG routines [14], special precautions have to be respected in the <lb/></body>

			<page> 2 <lb/></page>

			<note place="headnote"> 2 EXTENDED ADDITIONAL MUON INFORMATION <lb/></note>

			<body> EHISTORY option for primary ν  µ  -neutrinos (see Sect. 6.1). <lb/>The EHISTORY and MUPROD options cannot be combined with the CONEX, <lb/>INTTEST, and PARALLEL options, as in those options the identification of the <lb/>mother and grandmother of the muons is not possible. Using the ./coconut script <lb/>for installation of CORSIKA (see Appendix A) this conflicting options are au-<lb/>tomatically indicated and ./coconut blocks the simultaneous selection of EHIS-<lb/>TORY rsp. MUPROD with CONEX, INTTEST, or PARALLEL. <lb/>The present report updates the former report [15] which describes the opera-<lb/>tion of EHISTORY only. <lb/> 2 Extended Additional Muon Information <lb/> If in the EHISTORY option the keyword MUADDI is used in the steering file with <lb/>the FMUADD parameter set to .true., for each muon arriving at the detector level <lb/>4 consecutive entries of particle parameters are written to the particle data output <lb/>file: <lb/>1. The first entry contains the additional muon information as in the standard <lb/>CORSIKA version. This entry describes the muon at its production point. <lb/>The structure of this entry is given in Table 1. <lb/>2. The second entry comprises the parameters of the mother particle at the <lb/>place of its birth. It is described in the following Sect. 2.1. <lb/>3. The third entry contains the parameters of the grandmother particle at the <lb/>point of interaction where the mother particle is created. Details are listed <lb/>in Sect. 2.2. <lb/>4. The fourth entry gives the parameters of the muon arriving at the observa-<lb/>tion level. Details on this particle entry may be found in the CORSIKA <lb/>User&apos;s Guide [16] (see there Sect. 10.2 (Normal Particle Output) Table 10). <lb/>In the first entry the particle identification is 75 (for µ <lb/> +  ) or 76 (for µ <lb/> −  ). The x and <lb/>y-coordinates refer to the distance from the particle position to the intersection <lb/>point of the shower axis with the observation level. The z-coordinate gives the <lb/>altitude above sea level. <lb/> 2.1 Mother Particle <lb/> The second entry of the extended additional muon information describes the com-<lb/>ponents of momentum and position of the mother particle at the interaction point <lb/></body>

			<note place="headnote"> 2.1 Mother Particle <lb/></note>

			<page> 3 <lb/></page>

			<body> Table 1: Structure of muon at production data. <lb/>Additional muon information data : (7 rsp. 8 words each) <lb/>No. of word Contents of word (as real numbers R*4) <lb/> 7 × (n − 1) + 1 particle description encoded as: <lb/>part. id×1000 + hadr. generation×10 + no. of obs. level <lb/> 7 × (n − 1) + 2 px, momentum in x direction in GeV/c <lb/> 7 × (n − 1) + 3 py, momentum in y direction in GeV/c <lb/> 7 × (n − 1) + 4 pz, momentum in -z direction in GeV/c <lb/> 7 × (n − 1) + 5 x position coordinate (North) in cm <lb/> 7 × (n − 1) + 6 y position coordinate (West) in cm <lb/> 7 × (n − 1) + 7 z position coordinate (vertical) in cm <lb/> 7 × (n − 1) + 8 (weight in case of thinning) <lb/>for n = 1 . . . 39 <lb/> at which this particle has been produced. The x and y-coordinates refer to the dis-<lb/>tance from the particle position to the intersection point of the shower axis with <lb/>the observation level. The z-coordinate gives the altitude above sea level. For a <lb/>clear discrimination against normal particles the identification of the mother par-<lb/>ticle is written with negative sign. The arrangement of these parameters and their <lb/>meaning is given in Table 2. <lb/>Table 2: Structure of mother particle data. <lb/>Mother particle data : (7 rsp. 8 words each) <lb/>No. of word Contents of word (as real numbers R*4) <lb/> 7 × (n − 1) + 1 particle description encoded as: <lb/> - part. id×1000 + hadr. generation×10 + no. of obs. level <lb/> 7 × (n − 1) + 2 px, momentum in x direction in GeV/c <lb/> 7 × (n − 1) + 3 py, momentum in y direction in GeV/c <lb/> 7 × (n − 1) + 4 pz, momentum in -z direction in GeV/c <lb/> 7 × (n − 1) + 5 x position coordinate (North) in cm <lb/> 7 × (n − 1) + 6 y position coordinate (West) in cm <lb/> 7 × (n − 1) + 7 z position coordinate (vertical) in cm <lb/> 7 × (n − 1) + 8 (weight = 0 in case of thinning) <lb/>for n = 1 . . . 39 <lb/></body>

			<page> 4 <lb/></page>

			<note place="headnote"> 3 MUPROD OPTION <lb/></note>

			<body> 2.2 Grandmother Particle <lb/> In the third entry of the extended additional muon information the components <lb/>of momentum of the grandmother particle at its interaction point (end of range) <lb/>are described as well as the generation counter of the mother particle and the <lb/>penetrated matter thickness χ between the birth and the end of range of the grand-<lb/>mother particle. In the case of an electro-magnetic particle as grandmother particle <lb/>the value of χ is set to 0. The z-coordinate gives the altitude above sea level of <lb/>the interaction point and is – by construction – identical with the altitude of the <lb/>production point of the mother particle. For a clear discrimination against normal <lb/>particles the identification of the grandmother particle is written with negative <lb/> sign. The arrangement and meaning of the parameters is given in Table 3. <lb/>Table 3: Structure of grandmother particle data. <lb/>Grandmother particle data : (7 rsp. 8 words each) <lb/>No. of word Contents of word (as real numbers R*4) <lb/> 7 × (n − 1) + 1 particle description encoded as: <lb/> - part. id×1000 + hadr. generation×10 + no. of obs. level <lb/> 7 × (n − 1) + 2 px, momentum in x direction in GeV/c <lb/> 7 × (n − 1) + 3 py, momentum in y direction in GeV/c <lb/> 7 × (n − 1) + 4 pz, momentum in -z direction in GeV/c <lb/> 7 × (n − 1) + 5 generation counter of mother particle <lb/> 7 × (n − 1) + 6 χ, penetrated matter thickness (g/cm <lb/> 2  ) <lb/>between production and interaction point of grandmother <lb/>particle <lb/> 7 × (n − 1) + 7 z position coordinate (vertical) in cm <lb/> 7 × (n − 1) + 8 (weight = 0 in case of thinning) <lb/>for n = 1 . . . 39 <lb/> 3 MUPROD Option <lb/> In the MUPROD option the starting and end point coordinates and momentum <lb/>components of those muons are written which decay or interact within the at-<lb/>mosphere before reaching an observation level. These informations are given in <lb/>two entries written to the particle data output file, independently of the keyword <lb/>MUADDI. By combination with the EHISTORY option and setting the FMUADD <lb/>parameter of the MUADDI keyword to .true. also the information of the mother <lb/></body>

			<note place="headnote"> 3.1 Decaying Muon at Production <lb/></note>

			<page> 5 <lb/></page>

			<body> and grandmother particles of the decaying muon is written as two entries between <lb/>the starting and the decay point entry : <lb/>1. The first entry describes the information on the muon at its production (start-<lb/>ing) point. The structure of this entry is given in Table 4. <lb/>2. The second entry comprises the parameters of the mother particle at the <lb/>place of its birth and is described in the Sect. 2.1. <lb/>3. The third entry contains the parameters of the grandmother particle at the <lb/>point of interaction where the mother particle is created. Details are listed <lb/>in the Sect. 2.2. <lb/>4. The fourth entry gives the parameters of the muon arriving at the decay or <lb/>interaction point. In case of energy or angular cuts this point is the estimated <lb/>endpoint of the last tracking. Details on this particle entry resemble that <lb/>described in the CORSIKA User&apos;s Guide [16] (see there Sect. 10.2 (Normal <lb/> Particle Output) Table 10). But the observation level number is replaced by <lb/>the fate index and the arrival time is replaced by the altitude at the end of <lb/>the track. Details are given in Table 5. <lb/> 3.1 Decaying Muon at Production <lb/> The particle identification for the decaying muon at its birth is given by 85 (for <lb/> µ <lb/> +  ) rsp. 86 (for µ <lb/> −  ). The fate index indicates why the tracking of the muon ended: <lb/> • index = 1: muon track ends because of decay; <lb/> • index = 2: muon track ends because of fatal nuclear interaction; <lb/> • index = 3: muon track ends because of energy or angular cut. <lb/>The x and y-coordinates refer to the distance from the particle position to the <lb/>intersection point of the shower axis with the observation level. The z-coordinate <lb/>gives the altitude above sea level. Further details on the structure of this entry are <lb/>given in Table 4. <lb/>Mother and grandmother entries are described in Table 2 and 3. <lb/> 3.2 Muon at Decay Point <lb/> The particle identification for the decaying muon at the end of its track is given by <lb/>95 (for µ <lb/> +  ) rsp. 96 (for µ <lb/> −  ). The fate index is descibed in the previous Sect. 3.1. <lb/>The x and y-coordinates refer to the distance from the particle position to the <lb/></body>

			<page> 6 <lb/></page>

			<note place="headnote"> 3 MUPROD OPTION <lb/></note>

			<body> Table 4: Structure of decaying muon at production data. <lb/>Decaying muon start data : (7 rsp. 8 words each) <lb/>No. of word Contents of word (as real numbers R*4) <lb/> 7 × (n − 1) + 1 particle description encoded as: <lb/>part. id×1000 + hadr. generation×10 + fate index <lb/> 7 × (n − 1) + 2 px, momentum in x direction in GeV/c <lb/> 7 × (n − 1) + 3 py, momentum in y direction in GeV/c <lb/> 7 × (n − 1) + 4 pz, momentum in -z direction in GeV/c <lb/> 7 × (n − 1) + 5 x position coordinate (North) in cm <lb/> 7 × (n − 1) + 6 y position coordinate (West) in cm <lb/> 7 × (n − 1) + 7 z position coordinate (vertical) in cm <lb/> 7 × (n − 1) + 8 (weight in case of thinning) <lb/>for n = 1 . . . 39 <lb/> intersection point of the shower axis with the observation level. The z-coordinate <lb/>gives the altitude above sea level. Further details on the structure of this entry are <lb/>given in Table 5. <lb/>Table 5: Structure of decaying muon at track end data. <lb/>Decaying muon track end data : (7 rsp. 8 words each) <lb/>No. of word Contents of word (as real numbers R*4) <lb/> 7 × (n − 1) + 1 particle description encoded as: <lb/>part. id×1000 + hadr. generation×10 + fate index <lb/> 7 × (n − 1) + 2 px, momentum in x direction in GeV/c <lb/> 7 × (n − 1) + 3 py, momentum in y direction in GeV/c <lb/> 7 × (n − 1) + 4 pz, momentum in -z direction in GeV/c <lb/> 7 × (n − 1) + 5 x position coordinate (North) in cm <lb/> 7 × (n − 1) + 6 y position coordinate (West) in cm <lb/> 7 × (n − 1) + 7 z position coordinate (vertical) in cm <lb/>at (estimated) end of muon track <lb/> 7 × (n − 1) + 8 (weight in case of thinning) <lb/>for n = 1 . . . 39 <lb/></body>

			<page> 7 <lb/></page>

			<body> 4 Hadronic Generation Counter <lb/> The hadronic generation counter is incremented at each hadronic interaction or <lb/>decay by 1. These are interactions of the type: <lb/> hadron + air −→ hadron + X <lb/> γ + air <lb/> −→ hadron + X <lb/> γ + air <lb/> −→ ρ <lb/> 0 <lb/> (+ recoil nucleus) <lb/> γ + air <lb/> −→ ω (+ recoil nucleus) <lb/> But also in the µ <lb/> + <lb/> µ <lb/> −  pair creation <lb/> γ (+ air) <lb/> −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> the counter is incremented by one. In addition the generation counter is incre-<lb/>mented by one in all decays of hadrons. These are decays of π <lb/> 0  , K <lb/> ±  , K <lb/> 0 <lb/> S  , K <lb/> 0 <lb/> L  , η, <lb/> all strange baryons, and all charmed hadrons. Deviations from this general rule <lb/>exist in the decay of charged pions <lb/> π <lb/> ± <lb/> −→ µ <lb/> ± <lb/> + ν  µ <lb/> in which the counter is incremented by 51, but only if the counter of the decaying <lb/> π <lb/> ±  is below 49. Otherwise it is incremented by 1. <lb/>In the decay of charmed mesons <lb/> D −→ µ <lb/> ± <lb/> + X <lb/> the counter is incremented by 31. If after the incrementation the counter will ex-<lb/>ceed 99, it is clipped at 99. It is guaranteed that the generation counter never <lb/>exceeds the value of 99. <lb/>For electrons/positrons rsp. gammas coming from muon interactions or decays <lb/> µ <lb/> ± <lb/> −→ µ <lb/> ± <lb/> + γ (bremsstrahlung) <lb/> µ <lb/> ± <lb/> −→ µ <lb/> ± <lb/> + e <lb/> + <lb/> + e <lb/> − <lb/> (pair production) <lb/> µ <lb/> ± <lb/> −→ e <lb/> ± <lb/> + ν (decay) <lb/> the generation counter is incremented by 50 (but not for the µ <lb/> ±  !), but only if <lb/>the counter of the incoming muon is below 50. <lb/></body>

			<page> 8 <lb/></page>

			<note place="headnote"> 4 HADRONIC GENERATION COUNTER <lb/></note>

			<body> But in the decay of shortlived resonances <lb/> ∆ −→ p + π <lb/> ∆ −→ n + π <lb/> K <lb/>  * <lb/> −→ K + π <lb/>ρ <lb/> 0 <lb/> −→ π <lb/> + <lb/> + π <lb/> − <lb/> ρ <lb/> ± <lb/> −→ π <lb/> ± <lb/> + π <lb/> 0 <lb/> ω −→ π <lb/> + <lb/> + π <lb/> − <lb/> (+ π <lb/> 0 <lb/> ) <lb/> ω −→ π <lb/> 0 <lb/> + γ <lb/> the generation counter is not incremented. This non-incrementation of the gen-<lb/>eration counter is adapted to the behavior of different interaction models: Some <lb/>models are producing these shortlived resonances explicitly (e.g. HDPM), while <lb/>most others subsume these decays into the interactions because of their short life-<lb/>times without extra incrementation of the generation counter. <lb/>In &apos;standard&apos; history chains with production of a charged pion or kaon as <lb/>mother particle, the generation counter given for the final muon should be larger <lb/>than that of the mother particle (which is given as the 5 <lb/> th  element of the grand-<lb/>mother particle) by one (rsp. 51). But there exist various cases, in which the <lb/>incrementation is not obvious or deviates from 1 (rsp. 51): <lb/>1. Difference in generation counter = 51 : <lb/> γ (grandmother) + air −→ ρ <lb/> 0 <lb/> (mother) (+ recoil nucleus) <lb/> ρ <lb/> 0 <lb/> −→ π <lb/> + <lb/> + π <lb/> − <lb/> π <lb/> + <lb/> −→ µ <lb/> + <lb/> + ν  µ <lb/> 2. Difference in generation counter = 2 : <lb/> p (grandmother) + air −→ π <lb/> 0 <lb/> (mother) <lb/> π <lb/> 0 <lb/> −→ γ + γ <lb/>γ (+ air) −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> 3. Difference in generation counter = 2 : <lb/> p (grandmother) + air −→ η (mother) + X <lb/> η −→ γ + .... <lb/>γ (+ air) −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> 4. Difference in generation counter = 52 : <lb/> p (grandmother) + air −→ η (mother) + X <lb/> η −→ π <lb/> + <lb/> + .... <lb/></body>

			<page> 9 <lb/></page>

			<body> π <lb/> + <lb/> −→ µ <lb/> + <lb/> + ν  µ <lb/> 5. Difference in generation counter = 52 : <lb/> p (grandmother) + air −→ K <lb/> + <lb/> (mother) + X <lb/>K <lb/> + <lb/> −→ π <lb/> + <lb/> + .... <lb/>π <lb/> + <lb/> −→ µ <lb/> + <lb/> + ν  µ <lb/> 6. Difference in generation counter = 52 : <lb/> p (grandmother) + air −→ π <lb/> + <lb/> (mother) + X <lb/> π <lb/> + <lb/> −→ µ <lb/> + <lb/> + ν  µ <lb/> µ <lb/> + <lb/> −→ e <lb/> + <lb/> + ν  µ  + ν  e <lb/> e <lb/> + <lb/> (brems) → γ + e <lb/> + <lb/> γ (+ air) → µ <lb/> + <lb/> +µ <lb/> − <lb/> 7. Difference in generation counter = 3 : <lb/> p (grandmother) + air −→ η (mother) + X <lb/> η −→ π <lb/> 0 <lb/> + .... <lb/>π <lb/> 0 <lb/> −→ γ + γ <lb/>γ (+ air) −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> 8. Difference in generation counter = 3 : <lb/> p (grandmother) + air −→ K <lb/> 0 <lb/>S  (mother) + X <lb/>K <lb/> 0 <lb/>S  −→ π <lb/> 0 <lb/> + π <lb/> 0 <lb/> π <lb/> 0 <lb/> −→ γ + γ <lb/>γ (+ air) −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> 9. Difference in generation counter = 3 : <lb/> p (grandmother) + air −→ K <lb/> + <lb/> (mother) + X <lb/>K <lb/> + <lb/> −→ π <lb/> 0 <lb/> + .... <lb/>π <lb/> 0 <lb/> −→ γ + γ <lb/>γ (+ air) −→ µ <lb/> + <lb/> + µ <lb/> − <lb/> 10. Difference in generation counter &gt; 3 (or &gt; 53) : <lb/>These are very rare processes and are not considered here. <lb/>This list of examples is by far not complete, but should show the principles <lb/>which informations may be extracted out from the extra additional muon informa-<lb/>tion and how they should be interpreted. <lb/></body>

			<page> 10 <lb/></page>

			<note place="headnote"> 5 EXAMPLE OF DATA STRUCTURE <lb/></note>

			<body> 5 Example of Data Structure <lb/> The Normal Particle Output of an example is given here after converting it to the <lb/>printable ASCII format, omitting the RUNH and EVTH sub-blocks and starting <lb/>at the first data sub-block : <lb/> 7.55310E+04 1.82518E-01 4.69967E-02 2.95816E+01 5.68648E+02 2.07471E+02 1.31523E+06 <lb/>-8.00000E+03 2.93559E-01 1.08935E-01 4.48802E+01 5.96484E-01 1.76690E+00 1.40207E+06 <lb/>-1.40000E+04 2.94225E-02 8.65075E-02 1.06033E+03 2.00000E+00 4.78742E+00 1.40207E+06 <lb/>5.53100E+03 1.30290E-01 8.06676E-03 2.75639E+01 6.34655E+03 8.63597E+02 4.26427E+04 <lb/>3.54100E+03-4.52725E-02 3.71730E-03 2.63386E-01-7.44258E+04 4.76747E+03 4.28313E+04 <lb/>7.55610E+04 1.35527E-01 3.70782E-02 1.26679E+00 9.37453E+02 1.55127E+02 6.90708E+05 <lb/>-1.10000E+04 2.78868E-01 3.90948E-01 2.15358E+00 4.18276E+02-6.17455E+01 6.95700E+05 <lb/>-1.40000E+04 2.94180E-01 6.45013E-03 4.45223E+01 4.00000E+00 6.56265E+01 6.95700E+05 <lb/>5.56100E+03 7.64322E-02-6.92760E-03 3.86123E-01 8.03748E+04-1.21128E+03 4.30403E+04 <lb/> · · · · · · <lb/>· · · · · · <lb/> This example is now read by the ./corsikaread history program. Its output is dis-<lb/>played here: <lb/> Opening file DAT690009 <lb/>CORSIKA data file header: <lb/>run number: <lb/>690009 <lb/>date of start: <lb/>20090511 <lb/>program version: <lb/>6.950 <lb/>ANALYSIS: initialization of histograms 100 <lb/>GET SHOWER HEADER: new shower: 690009 <lb/>ID | ENERGY | <lb/>P x <lb/>| <lb/>P y <lb/>| <lb/>P z <lb/>| <lb/>x <lb/>| <lb/>y <lb/>| <lb/>z <lb/>|gen.counter| <lb/>chi <lb/>| <lb/>z <lb/>muon production point entry found: <lb/>75 2.958E+01 1.825E-01 4.700E-02 2.958E+01 5.68648E+02 2.07471E+02 1.31523E+06 <lb/>muon mother/grandmother entry found: <lb/>-8 4.488E+01 2.936E-01 1.089E-01 4.488E+01 5.96484E-01 1.76690E+00 1.40207E+06 <lb/>muon mother/grandmother entry found: <lb/>-14 1.060E+03 2.942E-02 8.651E-02 1.060E+03 2.00000E+00 4.78742E+00 1.40207E+06 <lb/>muon entry found: <lb/>5 2.756E+01 1.303E-01 8.067E-03 2.756E+01 6.34655E+03 8.63597E+02 <lb/>muon production point entry found: <lb/>75 1.275E+00 1.355E-01 3.708E-02 1.267E+00 9.37453E+02 1.55127E+02 6.90708E+05 <lb/></body>

			<page> 11 <lb/></page>

			<body> muon mother/grandmother entry found: <lb/>-11 2.261E+00 2.789E-01 3.909E-01 2.154E+00 4.18276E+02 -6.17455E+01 6.95700E+05 <lb/>muon mother/grandmother entry found: <lb/>-14 4.453E+01 2.942E-01 6.450E-03 4.452E+01 4.00000E+00 6.56265E+01 6.95700E+05 <lb/>muon entry found: <lb/>5 4.076E-01 7.643E-02-6.928E-03 3.861E-01 8.03748E+04 -1.21128E+03 <lb/> · · · · · · <lb/>· · · · · · <lb/> ANALYSIS: one complete shower read <lb/>1 <lb/>ID | ENERGY | <lb/>P x <lb/>| <lb/>P y <lb/>| <lb/>P z <lb/>| <lb/>x <lb/>| <lb/>y <lb/>| <lb/>z <lb/>|gen.counter| <lb/>chi <lb/>| <lb/>z <lb/>ANALYSIS: total number of showers: <lb/>1 <lb/>CORSIKA READ: analysis of file completed. <lb/> After the first muon (entries 1 to 4) an electron (entry 5) with ID = 3 and <lb/>generation counter 53 arrives at the observation level, but as it is no muon, it is <lb/>skipped in the ./corsikaread history program. In each entry the first word with the <lb/>particle ID is disentangled, but only the particle ID is printed in the first column <lb/>(without the generation counter and the observation level number). Additionally <lb/>to the three momentum components, printed in columns 3 to 5, the energies of <lb/>the particles are calculated from these momenta and printed in the second col-<lb/>umn. Columns 6 to 8 contain the position coordinates, in case of the grandmother <lb/>particle the columns 6 and 7 are filled with the generation counter of the mother <lb/> particle and the penetrated matter thickness χ of the grandmother particle. In the <lb/>above example the first muon with generation counter 53 comes from the decay <lb/>of the π <lb/> +  mother particle with generation counter 2; it is a normal particle history <lb/>with a proton grand mother particle. The second muon with generation counter <lb/>56 has a proton grand mother particle and a K <lb/> +  &apos;mother&apos; particle with generation <lb/>counter 4, the generation counter difference of 52 corresponds with the example <lb/>5 of the previous Sect. 4. <lb/></body>

			<page> 12 <lb/></page>

			<note place="headnote"> 6 LIMITATIONS <lb/></note>

			<body> 6 Limitations <lb/> 6.1 Neutrino Induced Showers <lb/> With the NUPRIM option in ν  µ  -neutrino induced showers, a muon is produced in <lb/>the first interaction due to lepton number conservation: <lb/> ν  µ  (grandmother) + air −→ µ <lb/> − <lb/> (mother) + X <lb/> If such a muon penetrates down to the detector level the extended additional muon <lb/>information gives the neutrino as grandmother and the muon as mother, even if <lb/>the muon did not make any further interaction. The generation counter of the <lb/> µ <lb/> −  (mother) is 1, as well as in the standard muon additional information (ID = <lb/>75011). <lb/> 6.2 Thinning <lb/> If the THIN option is selected together with the EHISTORY option the data struc-<lb/>ture will contain 8 words per item (instead of 7 without the THIN option). Weights <lb/>are given for all particles, but for the mother and grandmother particles the weights <lb/>are set to zero. Therefore it makes not very much sense to use the THIN option in <lb/>combination with the EHISTORY option and it is recommended to set the thresh-<lb/>old for the thinning at such a low level that the particles of interest have always <lb/>the weight equal to unity. <lb/> 6.3 Combination with STACKIN Option <lb/> A combination of the EHISTORY option with the STACKIN option is possible. <lb/>The secondary particles of the first interaction treated outside CORSIKA in a sep-<lb/>arate program are read in and their generation counter is set to 1. If one of these <lb/>particles decays directly to a muon which arrives at the detector level, the mother <lb/>and grandmother particles are written in the extended additional muon informa-<lb/>tion as usual. Despite the grandmother particle interaction being simulated in an <lb/>external program, it appears as grandmother particle with its parameters before its <lb/>interaction. Only the penetrated matter thickness between the birth of the grand-<lb/>mother particle and its interaction remains undefined. <lb/></body>

			<page> 13 <lb/></page>

			<body> 7 Application Example <lb/> In the following example 500 air showers induced by protons of 10 <lb/> 15  eV with ver-<lb/>tical incidence are analyzed. In the simulations the QGSJET01 [17] has been used <lb/>for the high-energy interactions, hadrons with energies below 80 GeV are treated <lb/>by the FLUKA model [18]. For the electro-magnetic portion of the showers the <lb/>analytical NKG-formulas [1, 19] have been used, so no muons e.g. coming from <lb/> µ <lb/> + <lb/> + µ <lb/> −  pair creation are to be expected. <lb/>In the Fig. 1 the kinetic energy spectra of various types of grandmother parti-<lb/>cles are plotted for the lateral distance range of the muons between 0 and 500 m <lb/>at ground level. In Fig. 2 the kinetic energy of all hadronic grandmother particles <lb/>is plotted for different lateral distance ranges of the muons arriving at ground. <lb/>Similar energy spectra but simulated with different interaction models are given <lb/>in Fig. 3.5 of Ref. [12], which have been produced with a preliminary version of <lb/>the EHISTORY option. <lb/>A further example of an earlier version of the EHISTORY option is given in <lb/>Ref. [20], where the pseudo-rapidities of muons arriving at the detector level are <lb/>compared with those of their (mesonic) mother particles. <lb/> 1 <lb/> 10 <lb/>10 <lb/> 2 <lb/> 10 <lb/> 3 <lb/> 10 <lb/> 4 <lb/> 10 <lb/> 5 <lb/> 1 <lb/>10 <lb/>10 <lb/> 2 <lb/> 10 <lb/> 3 <lb/> 10 <lb/> 4 <lb/> 10 <lb/> 5 <lb/> 10 <lb/> 6 <lb/> E (GeV) <lb/>dN/dlog <lb/> 10 E <lb/> π <lb/> ± <lb/> p + p <lb/> – <lb/> n + n <lb/> – <lb/> K <lb/> ± <lb/> vertical proton of 10 <lb/> 15 eV <lb/>0 &lt; r &lt; 500 m <lb/>500 showers added <lb/> Figure 1: Distribution of kinetic energy of different grandmother particle types in <lb/>vertical proton induced air showers for a muon lateral distance of 0 -500 m at <lb/>ground level. <lb/></body>

			<page> 14 <lb/></page>

			<note place="headnote"> 8 FINAL REMARKS <lb/></note>

			<body> 10 <lb/> 2 <lb/> 10 <lb/> 3 <lb/> 10 <lb/> 4 <lb/> 1 <lb/>10 <lb/>10 <lb/> 2 <lb/> 10 <lb/> 3 <lb/> 10 <lb/> 4 <lb/> 10 <lb/> 5 <lb/> 10 <lb/> 6 <lb/> E (GeV) <lb/>dN/dlog <lb/> 10 E <lb/> vertical proton of 10 <lb/> 15 eV <lb/>500 showers added <lb/>all grandmother particles added <lb/>200 &lt; r &lt; 500 m <lb/>50 &lt; r &lt; 200 m <lb/>0 &lt; r &lt; 50 m <lb/> Figure 2: Kinetic energy spectra of all grandmother particle types summed in ver-<lb/>tical proton induced air showers for different lateral distance ranges of the muons <lb/>at ground level. <lb/> 8 Final Remarks <lb/> The previous examples demonstrate the usefulness of the EHISTORY option for <lb/>systematic studies on the production history of muons in air showers. All relevant <lb/>parameters of the grandmother and mother particles and of the muons are stored <lb/>in the four items of the extended additional muon information to derive their en-<lb/>ergy spectra, the distributions of their production positions (altitude rsp. distance <lb/>from the shower axis), and their generation sequence. Further parameters like the <lb/>transverse momentum distribution obtained by the mother particles at their pro-<lb/>duction may easily be calculated from the momenta components of grandmother <lb/>and mother particles. All interesting features may easily be extracted by applying <lb/>appropriate selections and cuts to one or several parameters of the extended addi-<lb/>tional muon information when filling histograms in a run with a suitably modified <lb/>and extended version of the corsikaread history program. <lb/></body>

			<page> 15 <lb/></page>

			<body> A Installation of the EHISTORY Option <lb/> It is recommended to use the ./coconut (COrsika CONfiguration UTility) proce-<lb/>dure for the installation of the CORSIKA executable file. This script provides a <lb/>user interface through questions and answers for the various CORSIKA options. <lb/>The question <lb/>&apos;Which additional CORSIKA program options do you need ?&apos; <lb/>should be answered by typing &apos;s&apos; which selects the EHISTORY option. The <lb/>EHISTORY option should work in combination with nearly all other available <lb/>options, especially with all high-energy and low-energy hadronic interaction mod-<lb/>els, with the options CERENKOV, CHARM, CURVED, NEUTRINO, NUPRIM <lb/>(primary neutrino), SLANT, STACKIN, or UPWARD, but not with the CONEX, <lb/>INTTEST, or PARALLEL options, as in those options the generation sequence <lb/>of grandmother and mother particles is not established. Further details on the <lb/>CORSIKA installation you find in the CORSIKA User&apos;s Guide [16]. <lb/>For reading the particle data output file, a program frame corsikaread history.f <lb/> is supplied which might be modified to include the production of histograms for <lb/>plotting. In its basic version it prints just the extended additional muon informa-<lb/>tion (i.e. including that on mother and grandmother particles) for those muons <lb/>which arrive at the observation level rsp. decay or interact in the atmosphere <lb/>(MUPROD option). After compilation and linking of the corsikaread history.f <lb/> program the run is performed by calling: <lb/> ./corsikaread_history &gt; test.out <lb/> Then enter the file name (for example DAT690009). <lb/>The information for the arriving muons is written into the file test.out in the <lb/>readable ASCII format. If the THIN option has been used in the CORSIKA run, <lb/>the COMMON BLOCK sizes have to be adapted to use ./corsikaread history with <lb/>thinned/unthinned showers by setting the LENPAR parameter (LENPAR = 7 for <lb/>un-thinned, LENPAR = 8 for thinned showers). <lb/></body>

			<page> 16 <lb/></page>

			<note place="headnote"> REFERENCES <lb/></note>

			<listBibl> References <lb/> [1] D. Heck et al., CORSIKA: A Monte Carlo Code to Simulate Extensive <lb/>Air Showers, Report FZKA 6019, Forschungszentrum Karlsruhe (1998); <lb/>http://www-ik.fzk.de/corsika/physics description/corsika phys.html <lb/>[2] W.D. Apel et al., J. Phys. G: Nucl. Part. Phys. 36 (2009) 035201 <lb/>[3] P. Desiati et al. (AMANDA Collab.), Proc. 27 <lb/> th  Int. Cosmic Ray Conf., Ham-<lb/>burg, Germany (2001) 985 <lb/>[4] F. Schröder, W. Rhode, H. Meyer, Proc. 27 <lb/> th  Int. Cosmic Ray Conf., Ham-<lb/>burg, Germany (2001) 1013 <lb/>[5] V. Avati et al., Astropart. Phys. 19 (2003) 513 <lb/>[6] J. Abdallah et al. (DELPHI Collab.), Astropart. Phys. 28 (2007) 273 <lb/>[7] P. Achard et al. (L3 Collab.), Phys. Lett. B598 (2004) 15 <lb/>[8] J. Ridky, P. Travnicek, Nucl. Phys. B (Proc. Suppl.) 138 (2005) 295; P. <lb/>LeCoultre, Nucl. Phys. B (Proc. Suppl.) 122 (2003) 161 <lb/>[9] P. Berghaus, T. Montaruli, J. Ranft, Journal of Cosmology and Astroparticle <lb/>Physics, 0806 (2008) 003; arXiv: 0712.3089 [astro-ph] (2007) <lb/>[10] U. Dev Goswami, Astropart. Phys. 28 (2007) 251 <lb/>[11] D. Heck, Charmed Particles in CORSIKA, Report FZKA 7366, <lb/> Forschungszentrum Karlsruhe (2008); available from http://www-<lb/>ik.fzk.de/˜heck/publications <lb/>[12] C. Meurer et al., Czech. J. Phys. 56 (2006) A211; C. Meurer, Dissertation <lb/>University Karlsruhe (2007) <lb/>[13] A. Laszlo et al. (NA61 Collab.), Proc. 4 <lb/> th  Int. Workshop Critical Point and <lb/>Onset of Deconfinement, Darmstadt, Germany (2007); arXiv: 0709.1867 <lb/>[nucl-ex] (2007) <lb/>[14] G. Corcella et al., JHEP 0101 (2001) 010; G. Marchesini et al., Comp. <lb/>Phys. Comm. 67 (1992) 465; http://www.hep.phy.cam.ac.uk/theory/webber/ <lb/>Herwig/ <lb/>[15] D. Heck and R. Engel, The EHISTORY Option of the Air-Shower Simula-<lb/>tion Program CORSIKA, Report FZKA 7495, Forschungszentrum Karls-<lb/>ruhe (2009) <lb/></listBibl>

			<note place="headnote"> REFERENCES <lb/></note>

			<page> 17 <lb/> </page>

			<listBibl> [16] D. Heck and T. Pierog, Extensive Air Shower Simulation with COR-<lb/>SIKA: A User&apos;s Guide. The actual version is available from http://www-<lb/>ik.fzk.de/corsika/usersguide/corsika tech.html <lb/>[17] N.N. Kalmykov, S.S. Ostapchenko, and A.I. Pavlov, Nucl. Phys. B (Proc. <lb/>Suppl.) 52B (1997) 17 <lb/>[18] A. Ferrari, P.R. Sala, A. Fasò, and J. Ranft, FLUKA: a multi-particle trans-<lb/>port code, Report CERN-2005-10 (2005); INFN/TC 05/11; SLAC-R-773 <lb/> (2005); http://www.fluka.org/fluka.php?id=about <lb/>[19] A.A. Lagutin, A.V. Plyasheshnikov, and V.V. Uchaikin, Proc. 16 <lb/> th  Int. Cos-<lb/>mic Ray Conf., Kyoto, Japan, 7 (1979) 18; J.N. Capdevielle for KASCADE <lb/>Collab., Proc. 22 <lb/> nd  Int. Cosmic Ray Conf., Dublin, Ireland, 4 (1991) 405 <lb/>[20] J. Zabierowski et al., (KASCADE Collab.), Nucl. Phys. B (Proc. Suppl.) 151 <lb/> (2006) 291 <lb/></listBibl>

			<note place="headnote"> KIT Scientific Working Papers <lb/>ISSN 2194-1629 <lb/> www.kit.edu <lb/> KIT – University of the State of Baden-Wuerttemberg and National Research Center of the Helmholtz Association </note>


	</text>
</tei>
